<?xml version="1.0" encoding="UTF-8" ?>

<!--
## ********************************************************************* ##
## Copyright 2016                                                        ##
## Jack Green, Nick Chura                                                ##
##                                                                       ##
## This file is part of the Mount Hood Community College                 ##
## Precalculus Project                                                   ##
##                                                                       ##
## ********************************************************************* ##
-->

<chapter xml:id="chapter-composition-and-inverse" xmlns:xi="http://www.w3.org/2001/XInclude">

    <title>Composition of Functions and Inverses of Functions</title>

    <introduction>
        <objectives xml:id="outcomes-composition-and-inverse">
            <title>Student Learning Outcomes</title>
            <ul>
                <li><p>Define composite functions and combinations of functions and apply and interpret these in appropriate situations.</p></li>
                <li><p>Evaluate, apply, and interpret function notation, including the notation for inverse functions and composition of functions.</p></li>
                <li><p>Demonstrate the inverse relationship between an exponential function and a logarithmic function (with the same base).</p></li>
            </ul>
        </objectives>

        <list>
            <title>Video Lectures</title>
            <!-- If we can get these videos up onto YouTube, much easier to embed -->
            <dl>
                <li>
                    <title>Composition of Funcitons</title>
                    <!--<video source="http://stream.mhcc.edu/videos/greenja/captioned/m07-lec-composition-captioned_-_20150124_193451_26.html" />-->
                </li>
                <li>
                    <title>Inverses of Functions</title>
                    <!--<video source="http://stream.mhcc.edu/videos/greenja/captioned/m07-lec-inverse-functions-captioned_-_20150124_202541_26.html" />-->
                </li>
            </dl>
        </list>

    </introduction>

    <xi:include href="./activity-composition.xml" />
    <xi:include href="./activity-inverse.xml" />

    <conclusion>
      <subsection>
        <title>Gist of Composition and Inverses</title>
<todo> Fix units </todo>

        <p>The composition of functions is really about making one function the input for another. The following example shows function composition in the context of a patient taking blood pressure medicine.</p>
          <example>
            <p>Let <m>C</m> represent the concentration, measured in mg/kg, of a blood pressure regulating drug in a patient's bloodstream as a function of time <m>t</m>, measured in hours. As time goes on, the concentration of the drug in the bloodstream decreases as the body metabolizes and/or excretes it.</p>
            <p>At the same time, the drug is meant to help lower the patient's blood pressure <m>P</m>, measured in mm Hg. So, as the drug leaves the patient's bloodstream, the blood pressure increases.</p>
            <p>Therefore, <m>P</m> depends on <m>C</m>, and <m>C</m> depends on <m>t</m>.</p>
            <p>There is a function for the relationship between <m>C</m> and <m>t</m> &#8212; let's call it <m>f</m>, and write <m>C = f(t)</m>.</p>
<todo>Write a few teaser questions here.</todo>

            <p>There is another function for the relationship between <m>P</m> and <m>C</m> &#8212; let's call it <m>g</m>, and write <m>P = g(C)</m>.</p>
            <p>So, we would first use <m>f(t)</m> to find the concentration <m>C</m> of the drug in the bloodstream, and then use that amount in the function <m>g(C)</m> in order to find the patient's blood pressure <m>P</m>.</p>
            <p>In function notation, this would look like:<md>
              <mrow>P \amp= g(C)</mrow>
              <mrow>\amp=g(f(t))</mrow></md></p>
            <p>That last expression, <m>g(f(t))</m>, is a <term>composite</term> function, and it shows that the blood pressure is really a function of <m>t</m>.</p>



            <exercise>
              <webwork xml:id="heart-rate-evaluate">
                <setup>
                  <var name="$hours"><static>20</static></var>
                  <var name="$conExpression"><static>f(20)</static></var>
                  <var name="$bpOfConExpression"><static>g(f(20))</static></var>
                  <var name="$conAtHours"><static>5*exp(-0.058*20)</static></var>
                  <var name="$bpAtHours"><static>-12.5*(20-1)+160</static></var>
                  <pg-code>
                    Context('Numeric');
                    $hours = random(15,20,1);
                    $conAtHours=Compute("5*2.718282**(-0.058*$hours)");
                    $bpAtHours=Compute("-12.5*$conAtHours+172.5");
                  </pg-code>
                </setup>

                <statement>
                  <p>The blood pressure drug <em>lisinopril</em> works best when it is consumed at a concentration of 5 mg/kg, and its concentration decreases exponentially, with a half-life of 12 hours.</p>
                  <p>Therefore, the concentration can be modeled by the function<md>
                    <mrow>C = f(t) = 5e^{-0.058t}</mrow></md></p>
                  <p>Suppose that a patient with hypertension is admitted with blood pressure at 160 mm Hg. Administering the drug at a concentration of 5 mm/kg reduces their blood pressure to 110 mm Hg. As the drug's concentration diminishes over time, their blood pressure increases linearly, returning to 160 mm Hg when the concentration drops to 1 mg/kg.</p>
                  <p>Therefore, the blood pressure can be modeled by the function<md>
                    <mrow>P = g(C) = -12.5C + 172.5</mrow></md></p>
                  <ul>
                    <li><p>What is the concentration of the drug after <var name="$hours" /> hours?</p>
                    <p><m>C = f(<var name="$hours" />) = </m><var name="$conAtHours" width="15" /></p></li>
                    <li><p>What is the expected blood pressure after <var name="$hours" /> hours?</p>
                    <p><m>P = g(f(<var name="$hours" />)) = </m><var name="$bpAtHours" width="15" /></p></li>
                  </ul>
                </statement>
                <solution>
                  <ol>
                    <li><p>The concentration after <var name="$hours" /> hours is <var name="$conExpression" />, and its value is <var name="$conAtHours" /> mg/kg.</p></li>
                    <li><p>The blood pressure after <var name="$hours" /> hours is <var name="$bpOfConExpression" />, and its value is <var name="$bpAtHours" /> mm Hg.</p></li>
                  </ol>
                </solution>
              </webwork>
            </exercise>

            <exercise>
              <webwork xml:id="heart-rate-formula">
                <setup>
                  <var name="$concentration"><static>5*exp(-0.058*t)</static></var>
                  <var name="$bp"><static>-12.5*(5*exp(-0.058*t))+172.5</static></var>

                  <pg-code>
                    Context()->variables->are(t=>'Real');
                    $concentration=Compute("5*2.718282**(-0.058*t)");
                    $bp=Compute("-12.5*$concentration+172.5");
                  </pg-code>
                </setup>
                <statement>
                  <p>If we wanted to, we could have written the formula for <m>P</m> as a function of <m>t</m>, by just <term>composing</term> the two functions:<md>
                    <mrow>C \amp= f(t) = 5e^{-0.058t}</mrow>
                    <mrow>P \amp= g(C) = -12.5C + 172.5</mrow></md></p>
                  <p>Since <m>P = g(C) = g(f(t))</m>, we first replace <m>f(t)</m> with its formula:<md>
                    <mrow>P \amp= g(f(t))</mrow>
                    <mrow>\amp= g(<var name="$concentration" />)</mrow></md></p>
                  <p>Then we continue simplifying by using the formula for <m>g</m> of that input:<md>
                    <mrow>g(5e^{-0.058t}) \amp= <var name="$bp" /></mrow></md></p>
                </statement>
                <hint>

                </hint>
                <solution>

                </solution>
              </webwork>
            </exercise>
          </example>


          <paragraphs>
            <p>Given the formulas of two or more functions, we can write formulas for their compositions.</p>
          </paragraphs>

            <exercise>
              <webwork xml:id="composition-formula-examples">
                <setup>
                  <var name="$GofF"><static>(x/(x+4))^2</static></var>
                  <var name="$F"><static>x/(x+4)</static></var>
                  <pg-code>
                    $GofF=Compute("(x/(x+4))^2");
                    $F=Compute("x/(x+4)");
                  </pg-code>
                </setup>

                <statement>
                  <p>Let <m>f(x) = \frac{\displaystyle{x}}{\displaystyle{x + 4}}</m> and <m>g(x) = x^2</m>.</p>
                  <ul>
                    <li><p>Write the formula for the composite function <m>g(f(x))</m>.</p>
                    <p>We will start by substituting the formula for <m>g(x)</m> into the function <m>f</m>:</p>
                    <p><m>g(f(x)) = g(</m><var name="$F" width="15" /><m>)</m></p></li>
                    <li><p>Now simplify the expression you wrote above, by using the formula for <m>g(x)</m>.</p>
                    <p><m>g(f(x)) = </m><var name="$GofF" width="15" /></p></li>
                  </ul>
                </statement>

                <hint>

                </hint>
                <solution>

                </solution>
              </webwork>
            </exercise>
      </subsection>


      <subsection>
        <title>Inverses</title>

      </subsection>

    </conclusion>



</chapter>
