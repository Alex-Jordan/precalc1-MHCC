<?xml version="1.0" encoding="UTF-8" ?>

<!--
## ********************************************************************* ##
## Copyright 2016                                                        ##
## Jack Green, Nick Chura                                                ##
##                                                                       ##
## This file is part of the Mount Hood Community College                 ##
## Precalculus Project                                                   ##
##                                                                       ##
## ********************************************************************* ##
-->

<chapter xml:id="chapter-composition-and-inverse" xmlns:xi="http://www.w3.org/2001/XInclude">

    <title>Composition of Functions and Inverses of Functions</title>

    <introduction>
        <objectives xml:id="outcomes-composition-and-inverse">
            <title>Student Learning Outcomes</title>
            <ul>
                <li><p>Define composite functions and combinations of functions and apply and interpret these in appropriate situations.</p></li>
                <li><p>Evaluate, apply, and interpret function notation, including the notation for inverse functions and composition of functions.</p></li>
                <li><p>Demonstrate the inverse relationship between an exponential function and a logarithmic function (with the same base).</p></li>
            </ul>
        </objectives>

        <list>
            <title>Video Lectures</title>
            <!-- If we can get these videos up onto YouTube, much easier to embed -->
            <dl>
                <li>
                    <title>Composition of Funcitons</title>
                    <!--<video source="http://stream.mhcc.edu/videos/greenja/captioned/m07-lec-composition-captioned_-_20150124_193451_26.html" />-->
                </li>
                <li>
                    <title>Inverses of Functions</title>
                    <!--<video source="http://stream.mhcc.edu/videos/greenja/captioned/m07-lec-inverse-functions-captioned_-_20150124_202541_26.html" />-->
                </li>
            </dl>
        </list>

    </introduction>

    <xi:include href="./activity-composition.xml" />
    <xi:include href="./activity-inverse.xml" />

    <conclusion>
      <subsection>
        <title>Gist of Composition and Inverses</title>
<todo> Fix units </todo>

        <p>The composition of functions is really about making one function the input for another. The following example shows function composition in the context of a patient taking blood pressure medicine.</p>
          <example>
            <p>Let <m>C</m> represent the concentration, measured in mg/kg, of a blood pressure regulating drug in a patient's bloodstream as a function of time <m>t</m>, measured in hours. As time goes on, the concentration of the drug in the bloodstream decreases as the body metabolizes and/or excretes it.</p>
            <p>At the same time, the drug is meant to help lower the patient's blood pressure <m>P</m>, measured in mm Hg. So, as the drug leaves the patient's bloodstream, the blood pressure increases.</p>
            <p>Therefore, <m>P</m> depends on <m>C</m>, and <m>C</m> depends on <m>t</m>.</p>
            <p>There is a function for the relationship between <m>C</m> and <m>t</m> &#8212; let's call it <m>f</m>, and write <m>C = f(t)</m>.</p>
<todo>Write a few teaser questions here.</todo>

            <p>There is another function for the relationship between <m>P</m> and <m>C</m> &#8212; let's call it <m>g</m>, and write <m>P = g(C)</m>.</p>
            <p>So, we would first use <m>f(t)</m> to find the concentration <m>C</m> of the drug in the bloodstream, and then use that amount in the function <m>g(C)</m> in order to find the patient's blood pressure <m>P</m>.</p>
            <p>In function notation, this would look like:<md>
              <mrow>P \amp= g(C)</mrow>
              <mrow>\amp=g(f(t))</mrow></md></p>
            <p>That last expression, <m>g(f(t))</m>, is a <term>composite</term> function, and it shows that the blood pressure is really a function of <m>t</m>.</p>



            <exercise>
              <webwork xml:id="heart-rate-evaluate">
                <setup>
                  <var name="$hours"><static>20</static></var>
                  <var name="$conExpression"><static>f(20)</static></var>
                  <var name="$bpOfConExpression"><static>g(f(20))</static></var>
                  <var name="$conAtHours"><static>5*exp(-0.058*20)</static></var>
                  <var name="$bpAtHours"><static>-12.5*(20-1)+160</static></var>
                  <pg-code>
                    Context('Numeric');
                    $hours = random(15,20,1);
                    $conAtHours=Compute("5*2.718282**(-0.058*$hours)");
                    $bpAtHours=Compute("-12.5*$conAtHours+172.5");
                  </pg-code>
                </setup>

                <statement>
                  <p>The blood pressure drug <em>lisinopril</em> works best when it is consumed at a concentration of 5 mg/kg, and its concentration decreases exponentially, with a half-life of 12 hours.</p>
                  <p>Therefore, the concentration can be modeled by the function<md>
                    <mrow>C = f(t) = 5e^{-0.058t}</mrow></md></p>
                  <p>Suppose that a patient with hypertension is admitted with blood pressure at 160 mm Hg. Administering the drug at a concentration of 5 mm/kg reduces their blood pressure to 110 mm Hg. As the drug's concentration diminishes over time, their blood pressure increases linearly, returning to 160 mm Hg when the concentration drops to 1 mg/kg.</p>
                  <p>Therefore, the blood pressure can be modeled by the function<md>
                    <mrow>P = g(C) = -12.5C + 172.5</mrow></md></p>
                  <ul>
                    <li><p>What is the concentration of the drug after <var name="$hours" /> hours?</p>
                    <p><m>C = f(<var name="$hours" />) = </m><var name="$conAtHours" width="15" /></p></li>
                    <li><p>What is the expected blood pressure after <var name="$hours" /> hours?</p>
                    <p><m>P = g(f(<var name="$hours" />)) = </m><var name="$bpAtHours" width="15" /></p></li>
                  </ul>
                </statement>
                <solution>
                  <ol>
                    <li><p>The concentration after <var name="$hours" /> hours is <var name="$conExpression" />, and its value is <var name="$conAtHours" /> mg/kg.</p></li>
                    <li><p>The blood pressure after <var name="$hours" /> hours is <var name="$bpOfConExpression" />, and its value is <var name="$bpAtHours" /> mm Hg.</p></li>
                  </ol>
                </solution>
              </webwork>
            </exercise>

            <exercise>
              <webwork xml:id="heart-rate-formula">
                <setup>
                  <var name="$concentration"><static>5*exp(-0.058*t)</static></var>
                  <var name="$bp"><static>-12.5*(5*exp(-0.058*t))+172.5</static></var>

                  <pg-code>
                    Context()->variables->are(t=>'Real');
                    $concentration=Compute("5*2.718282**(-0.058*t)");
                    $bp=Compute("-12.5*$concentration+172.5");
                  </pg-code>
                </setup>
                <statement>
                  <p>If we wanted to, we could have written the formula for <m>P</m> as a function of <m>t</m>, by just <term>composing</term> the two functions:<md>
                    <mrow>C \amp= f(t) = 5e^{-0.058t}</mrow>
                    <mrow>P \amp= g(C) = -12.5C + 172.5</mrow></md></p>
                  <p>Since <m>P = g(C) = g(f(t))</m>, we first replace <m>f(t)</m> with its formula:<md>
                    <mrow>P \amp= g(f(t))</mrow>
                    <mrow>\amp= g(<var name="$concentration" />)</mrow></md></p>
                  <p>Then we continue simplifying by using the formula for <m>g</m> of that input:<md>
                    <mrow>g(5e^{-0.058t}) \amp= <var name="$bp" /></mrow></md></p>
                </statement>
                <hint>

                </hint>
                <solution>

                </solution>
              </webwork>
            </exercise>
          </example>


          <paragraphs>
            <p>Given the formulas of two or more functions, we can write formulas for their compositions.</p>
          </paragraphs>

            <exercise>
              <webwork xml:id="composition-formula-examples">
                <setup>
                  <var name="$GofF"><static>(x/(x+4))^2</static></var>
                  <var name="$F"><static>x/(x+4)</static></var>
                  <pg-code>
                    $GofF=Compute("(x/(x+4))^2");
                    $F=Compute("x/(x+4)");
                  </pg-code>
                </setup>

                <statement>
                  <p>Let <m>f(x) = \frac{\displaystyle{x}}{\displaystyle{x + 4}}</m> and <m>g(x) = x^2</m>.</p>
                  <ul>
                    <li><p>Write the formula for the composite function <m>g(f(x))</m>.</p>
                    <p>We will start by substituting the formula for <m>g(x)</m> into the function <m>f</m>:</p>
                    <p><m>g(f(x)) = g(</m><var name="$F" width="15" /><m>)</m></p></li>
                    <li><p>Now simplify the expression you wrote above, by using the formula for <m>g(x)</m>.</p>
                    <p><m>g(f(x)) = </m><var name="$GofF" width="15" /></p></li>
                  </ul>
                </statement>

                <hint>

                </hint>
                <solution>

                </solution>
              </webwork>
            </exercise>
      </subsection>


      <subsection>
        <title>Gist of Inverses</title>
        <p>Two functions are called <term>inverses</term> if they <em>undo</em> each other. If one function has a certain process, then the other function will have the opposite process.</p>
        <p>If <m>f</m> and <m>g</m> are inverses, then both of the following must be true: <md>
        <mrow>f(g(x)) \amp= x</mrow>
        <mrow>g(f(x)) \amp= x</mrow></md></p>
        <example>
          <p>The functions <m>f(x) = 2^x + 1</m> and <m>g(x) = log_{2}(x - 1)</m> are inverses.</p>
          <p>In order to show this, we would use function composition to show that both of the conditions above are true.</p>
          <md>
            <mrow>f(g(x)) \amp= f(log_{2}(x - 1))</mrow>
            <mrow>\amp= 2^{\displaystyle{log_{2}(x - 1)}} + 1</mrow>
            <mrow>\amp= (x - 1) + 1</mrow>
            <mrow>\amp= x</mrow>
          </md>
          <p>This shows that <m>f(g(x)) = x</m>. We should also show that <m>g(f(x)) = x</m>.</p>

          <exercise>
            <webwork xml:id="webwork-verify-inverse">
              <setup>
                <var name="$GofF">
                  <set>
                    <member correct="yes"><static>log_{2}(2^x + 1) - 1</static></member>
                    <member>log_{2}(x) - 2^x</member>
                  </set>
                </var>
                <pg-code>
                  $GofF=RadioButtons(
                      ["\(log_{2}((2^x + 1) - 1)\)","\(log_{2}(x) - 2^x\)"],
                      0, labels => ["log_2(2^x+1)-1","log_2(x)-2^x"],
                      displayLabels => 0
                  );
                </pg-code>
              </setup>
              <statement>
                <p>For the functions <me>f(x) = 2^x + 1 \text{  and  } g(x) = log_{2}(x - 1)</me> we want to show that <m>g(f(x))</m> is just equal to <m>x</m>.</p>
                <p>Which of the following is the correct way to write the composition <m>g(f(x))</m>?</p>
                <p><var name="$GofF" form="buttons" /></p>
              </statement>
              <hint>
                <p>The function <m>g</m> is the outside function, so the answer should <em>look</em> like: <me>log_{2}(\text{something} - 1)</me></p>
              </hint>
              <solution>
                <p>The correct way to write <m>g(f(x))</m> is: <me>log_{2}((2^x + 1) - 1)</me></p>
                <p>Notice that this <em>looks</em> like the function <m>g</m>, but with <m>2^x + 1</m> in place of the input.</p>
              </solution>
            </webwork>
          </exercise>
        </example>

        <paragraphs>
          <title>Notation</title>
          <p>If <m>h(x)</m> is a function, then its inverse is called <m>h^{-1}</m>. This notation does <em xml:id="note-about-inverse-exponent">not</em> mean that <m>h</m> is being raised to a negative exponent &#8212; rather, it is just special notation for an inverse function.</p>
          <p>We use this special notation either when we want to talk about the inverse of some function, or when we want to find the formula for the inverse.</p>
        </paragraphs>

        <paragraphs>
          <title>Interpreting the notation</title>
          <p>If <m>f</m> takes an input <m>a</m> and gives an output <m>b</m>, then its inverse <m>f^{-1}</m> would take <m>b</m> as the input and give the output <m>a</m>.</p>
        </paragraphs>

          <example>
            <p>Let <m>P(t)</m> be the function which calculates the population of a small town, where <m>t</m> is the number of years after 2000.</p>
            <p>Since <m>P</m> takes <em>years</em> as input and gives <em>people</em> as ouput, we should also be able to describe the meaning of the inverse, <m>P^{-1}</m>.</p>

            <exercise>
              <webwork>
                <pg-macros>
                  <macro-file>PGchoicemacros.pl</macro-file>
                </pg-macros>
                <setup>
                  <var name="$m"><static>33</static></var>
                  <var name="$x[0]"><static>10</static></var>
                  <var name="$x[1]"><static>15</static></var>
                  <var name="$y[0]"><static>780</static></var>
                  <var name="$y[1]"><static>945</static></var>
                  <var name="$inverseInput">
                    <set>
                      <member>\text{?}</member>
                      <member>\text{Years}</member>
                      <member>\text{People}</member>
                    </set>
                  </var>

                  <pg-code>
                    $m=random(25,35,1);
                    @x=map{$_+2}NchooseK(14,2);
                    @y=map{450+$_*$m}@x;
                    $inverseInput=PopUp(
                    ["?","Years","People"],"People");
                  </pg-code>
                </setup>

                <statement>
                  <p>Since <m>P^{-1}</m> is the opposite process of <m>P</m>, what is a possible input for <m>P^{-1}</m>?</p>
                  <p><var name="$inverseInput" form="popup" /></p>
                  <p>Suppose <m>P(<var name="$x[0]" />) = <var name="$y[0]" /></m> and <m>P(<var name="$x[1]" />) = <var name="$y[1]" /></m></p>
                  <p>What is <m>P^{-1}(<var name="$y[1]" />)</m>?</p>
                  <p>Answer:  <var name="$x[1]" width="10" /></p>
                </statement>
                <hint>
                  <p>A function and its inverse do opposite things: The input and ouput for one function become the output and input for the inverse function.</p>
                </hint>
                <solution>
                  <ol>
                    <li><p>For <m>P^{-1}</m>, the inputs must be <var name="$inverseInput" />, because those were the outputs from the function <m>P</m></p></li>
                    <li><p>Since <m>P(<var name="$x[1]" />) = <var name="$y[1]" /></m>, then we swap the input and output and see that: <me>P^{-1}(<var name="$y[1]" />) = <var name="$x[1]" /></me></p></li>
                  </ol>
                </solution>
              </webwork>
            </exercise>
          </example>

          <example>
            <p>On a cold day, when the wind blows, it <em>feels</em> colder than it actually is outside. The temperature you feel is called the <em>wind chill</em> temperature.</p>

            <exercise>
              <webwork xml:id="webwork-windchill">
                <pg-macros>
                  <macro-file>PGchoicemacros.pl</macro-file>
                </pg-macros>
                <setup>
                  <var name="$rand[0]"><static>0</static></var>
                  <var name="$rand[1]"><static>1</static></var>
                  <var name="$x[0]"><static>0</static></var>
                  <var name="$x[1]"><static>10</static></var>
                  <var name="$x[2]"><static>20</static></var>
                  <var name="$x[3]"><static>30</static></var>
                  <var name="$x[4]"><static>40</static></var>
                  <var name="$x[5]"><static>50</static></var>
                  <var name="$x[6]"><static>60</static></var>
                  <var name="$f[0]"><static>40</static></var>
                  <var name="$f[1]"><static>34</static></var>
                  <var name="$f[2]"><static>30</static></var>
                  <var name="$f[3]"><static>28</static></var>
                  <var name="$f[4]"><static>27</static></var>
                  <var name="$f[5]"><static>26</static></var>
                  <var name="$f[6]"><static>25</static></var>
                  <var name="$statements">
                    <set>
                      <member>W(28) = 30\text{ and }W^{-1}(50) = 26</member>
                      <member correct="yes">W(30) = 28\text{ and }W^{-1}(26) = 50</member>
                    </set>
                  </var>

                  <pg-code>
                    @rand=map{$_+1}NchooseK(6,4);
                    @x=(0,10,20,30,40,50,60);
                    @f=(40,34,30,28,27,26,25);
                    $statements=RadioButtons(
                    ["\(W($f[$rand[0]])=$x[$rand[0]]\) and \(W^{-1}($x[$rand[1]])=$f[$rand[1]]\)", "\(W($x[$rand[2]])=$f[$rand[2]]\) and \(W^{-1}($f[$rand[3]])=$x[$rand[3]]\)"],
                    1, labels => ["no","way"],
                    displayLabels => 0
                );

                  </pg-code>
                </setup>
                <statement>
                  <p>The table below shows values of the function <m>W(S)</m>, which calculates the wind chill temperature when it is <m>40 {}^{0}F</m> outside and the wind is blowing at <m>S</m> miles per hour.</p>
                  <table>
                    <tabular top="major" halign="center">
                          <col halign="left" />
                          <col />

                          <row bottom="medium">
                            <cell><m>S</m></cell>
                            <cell><m>W(S)</m></cell>
                          </row>

                          <row>
                            <cell><m><var name="$x[0]" /></m></cell>
                            <cell><var name="$f[0]" /></cell>
                          </row>

                          <row>
                            <cell><m><var name="$x[1]" /></m></cell>
                            <cell><var name="$f[1]" /></cell>
                          </row>

                          <row>
                            <cell><m><var name="$x[2]" /></m></cell>
                            <cell><var name="$f[2]" /></cell>
                          </row>

                          <row>
                            <cell><m><var name="$x[3]" /></m></cell>
                            <cell><var name="$f[3]" /></cell>
                          </row>

                          <row>
                            <cell><m><var name="$x[4]" /></m></cell>
                            <cell><var name="$f[4]" /></cell>
                          </row>

                          <row>
                            <cell><m><var name="$x[5]" /></m></cell>
                            <cell><var name="$f[5]" /></cell>
                          </row>

                          <row>
                            <cell><m><var name="$x[6]" /></m></cell>
                            <cell><var name="$f[6]" /></cell>
                          </row>

                    </tabular>
                  </table>
                  <p>Which pair of statements is true?</p>
                  <p><var name="$statements" form="buttons" /></p>


                </statement>
                <hint>

                </hint>
                <solution>

                </solution>
              </webwork>
            </exercise>
          </example>





      </subsection>
    </conclusion>
</chapter>
